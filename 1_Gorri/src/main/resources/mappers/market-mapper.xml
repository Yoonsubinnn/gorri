<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org/DTD Mapper 3.0/EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="marketMapper">

	<!-- 단순히 페이지네이션을 위한 count입니다. -->
	<select id="getListCount" resultType="_int">
		select count(*)
		from product
	</select>
	<!-- 마켓 메인페이지로 보내는 메소드입니다. -->
	<select id="marketMainPage" resultMap="ProductBoardResultSet">
		SELECT *
		FROM PRODUCT
		WHERE pro_name LIKE '%${search}%' and category like '%${category}%'
	</select>

	<!-- 상품의 상세 정보를 위한 매핑입니다. -->
	<select id="getProductInfo" resultMap="ProductBoardResultSet">
		select *
		from product
		where PRODUCT_NO = #{productId}
	</select>

	
	<!-- 상품의 판매자 객체를 위한 매핑입니다. -->
	<select id="getSellerInfo" resultMap="memberResultSet">
		select *
		from member
		where USERS_ID = #{seller}
	</select>

	<!-- 상품의 모든 문의를 가져오는 메소드 -->
	<select id="ProductAllInquire" resultMap="inquireResultSet">
		select *
		from inquire
		where product_no = #{productId}
	</select>

	<!-- 상품의 모든 후기를 가져오는 메소드 -->
	<select id="ProductAllReview" resultMap="reviewResultSet" >
		select *
		from review
		where product_no = #{productId}
	</select>
	
	<insert id="insertProduct">
		insert into product
		values(seq_product.nextval, #{productName}, #{productContent}, #{productPrice}, sysdate, sysdate, #{productCategory}, #{productSellerId})
	</insert>
	
	<select id="ProductOneReview" resultMap="reviewResultSet">
		select *
		from review
		where product_no = #{productId} and review_no = #{reviewNo}
	</select>
	
	<select id="ProductOneInquire" resultMap="inquireResultSet">
		select *
		from inquire
		where product_no = #{productId} and inquire_no = #{inquireNo}
	</select>
	
	<select id="ProductOneInquireReply" resultMap="inquireReplyResultSet">
		select *
		from inquire_reply
		where product_no = #{productId} and inquire_no = #{inquireNo}
	</select>
	

		<!--resultMaps -->
	<!-- Product. -->
	<resultMap type="Product" id="ProductBoardResultSet">
		<id column="PRODUCT_NO" property="productNo"/>
		<result column="PRO_NAME" property="productName"/>
		<result column="PRO_CONTENT" property="productContent"/>
		<result column="PRICE" property="productPrice"/>
		<result column="POSTDATE" property="productPostDate"/>
		<result column="MODIFY_DATE" property="productModifyDate"/>
		<result column="CATEGORY" property="productCategory"/>
		<result column="SELLER_ID" property="productSellerId"/>
	</resultMap>

	<!-- Member -->
	<resultMap type="Member" id="memberResultSet">
		<id column="USERS_ID" property="userId"/>
		<result column="PWD" property="userPwd"/>
		<result column="PWD_Q" property="pwdQ"/>
		<result column="PWD_HINT" property="pwdHint"/>
		<result column="NAME" property="userName"/>
		<result column="ADDRESS" property="address"/>
		<result column="WALLET" property="wallet"/>
		<result column="ENROLLDATE" property="enrollDate"/>
		<result column="PHONE" property="phone"/>
		<result column="NICKNAME" property="nickName"/>
		<result column="MYINTRO" property="myIntro"/>
		<result column="STATUS" property="status"/>
		<result column="IS_ADMIN" property="isAdmin"/>		
	</resultMap>
	
	<!-- Inquire -->
	<resultMap type="Inquire" id="inquireResultSet">
		<id column="INQUIRE_NO" property="inquireNo"/>
		<result column="INQUIRE_CONTENT" property="inquireContent"/>
		<result column="POSTDATE" property="inquirePostDate"/>
		<result column="BUYER_ID" property="buyerId"/>
		<result column="PRODUCT_NO" property="productNo"/>
	</resultMap>

	<!-- Delivery -->
	<resultMap type="Delivery" id="deliveryResultSet">
		<id column="DELIVERY_NO" property="deliveryNo"/>
		<result column="DELDATE" property="deliveryDate"/>
		<result column="DEL_STATUS" property="deliveryStatus"/>
		<result column="PAY_NO" property="paymentNo"/>
	</resultMap>
	
	<!-- Review -->
	<resultMap type="Review" id="reviewResultSet">
		<id column="REVIEW_NO" property="reviewNo"/>
		<result column="REVIEW_CONTENT" property="reviewContent"/>
		<result column="POSTDATE" property="reviewPostDate"/>
		<result column="BUYER_ID" property="buyerId"/>
		<result column="PRODUCT_NO" property="productNo"/>
	</resultMap>
	
	<!-- Pay -->
	<resultMap type="Pay" id="payResultSet">
		<id column="PAY_NO" property="paymentNo;"/>
		<result column="PAYDATE" property="paymentDate;"/>
		<result column="AMOUNT" property="quantity;"/>
		<result column="PAYMENTAMOUNT" property="paymentAmount;"/>
		<result column="PRODUCT_NO" property="productNo;"/>
		<result column="BUYER_ID" property="buyerId;"/>
	</resultMap>
	
	<!-- InquireReply -->
	<resultMap type="InquireReply" id="inquireReplyResultSet">
		<result column="INQUIRE_NO2" property="inquireNo"/>
		<result column="PRODUCT_NO2" property="productNo"/>
		<result column="REPLY_NO" property="replyNo"/>
		<result column="REPLY_CONTENT" property="replyContent"/>
		<result column="REPLY_WRITER" property="replyWriter"/>
		<result column="REPLY_CREATE_DATE" property="replyCreateDate"/>
		<result column="REPLY_MODIFY_DATE" property="replyModifyDate"/>
	</resultMap>
</mapper>
